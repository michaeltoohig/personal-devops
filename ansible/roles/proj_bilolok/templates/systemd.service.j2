[Unit]
Description=%i service with docker-compose
Requires=docker.service
After=docker.service

[Service]
Type=oneshot
RemainAfterExit=yes
User={{ app_user }}
Group={{ app_group }}
WorkingDirectory=/opt/%i/app
EnvironmentFile=/opt/%i/app/config/.env.compose
ExecStart=/usr/bin/docker compose -f docker-compose.{{ environment_name }}.yml up -d
ExecStop=/usr/bin/docker compose -f docker-compose.{{ environment_name }}.yml down
TimeoutStartSec=0

# Additional security enhancements to test
#ProtectSystem=full
#ProtectHome=true
#PrivateTmp=true
#NoNewPrivileges=true
#CapabilityBoundingSet=CAP_NET_BIND_SERVICE
#AmbientCapabilities=CAP_NET_BIND_SERVICE

# Additional logging enhancements to test
StandardOutput=journal
StandardError=journal
SyslogIdentifier=%i-docker-compose

[Install]
WantedBy=multi-user.target
